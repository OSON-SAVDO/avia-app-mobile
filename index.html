<!DOCTYPE html>
<html lang="tg">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Traveler.tj ‚Äî –°–∏—Å—Ç–µ–º–∞–∏ “∑—É—Å—Ç—É“∑”Ø–∏ —á–∏–ø—Ç–∞“≥–æ</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 0; background-color: #f0f2f5; padding-bottom: 80px; }
        header { background: linear-gradient(135deg, #0073ff, #0056b3); color: white; padding: 35px 20px; text-align: center; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); }
        .container { max-width: 800px; margin: 20px auto; width: 92%; }
        .card { background: white; padding: 20px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); margin-bottom: 25px; border: 1px solid #eee; }
        h2 { font-size: 19px; color: #0056b3; margin-top: 0; display: flex; align-items: center; gap: 10px; }
        
        /* –ù–∞–≤–∏–≥–∞—Ç—Å–∏—è–∏ –ø–æ—ë–Ω */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; background: white; display: flex; justify-content: space-around; padding: 12px 0; border-top: 1px solid #ddd; box-shadow: 0 -3px 10px rgba(0,0,0,0.05); z-index: 1000; }
        .nav-item { text-align: center; color: #555; text-decoration: none; font-size: 13px; cursor: pointer; transition: 0.3s; }
        .nav-item:active { color: #0073ff; }

        /* –ú–æ–¥–∞–ª–∏ –¢–∞–Ω–∑–∏–º–æ—Ç */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 2000; backdrop-filter: blur(5px); }
        .modal-content { background: white; width: 85%; max-width: 400px; margin: 15% auto; padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); }
        .modal-header { font-size: 22px; font-weight: bold; margin-bottom: 20px; color: #333; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #666; }
        select { width: 100%; padding: 12px; margin-bottom: 20px; border-radius: 12px; border: 1px solid #ddd; font-size: 16px; outline: none; }
        .save-btn { background: #0073ff; color: white; border: none; padding: 15px; border-radius: 12px; width: 100%; cursor: pointer; font-size: 16px; font-weight: bold; transition: 0.3s; }
        .save-btn:hover { background: #0056b3; }
    </style>
</head>
<body>

<header>
    <h1 id="site-title">Traveler.tj</h1>
    <p id="site-desc">–ß–∏–ø—Ç–∞“≥–æ, –ú–µ“≥–º–æ–Ω—Ö–æ–Ω–∞“≥–æ –≤–∞ –°–∞—ë“≥–∞—Ç“≥–æ</p>
</header>

<div class="container">
    <div class="card">
        <h2 id="title-avia">‚úàÔ∏è –ß–∏–ø—Ç–∞“≥–æ–∏ “≥–∞–≤–æ–ø–∞–π–º–æ</h2>
        <div id="avia-widget-container"></div>
    </div>

    <div class="card">
        <h2 id="title-klook">üåç –°–∞—ë“≥–∞—Ç –≤–∞ –≤–∞“õ—Ç—Ö—É—à–∏“≥–æ</h2>
        <div id="klook-widget-container"></div>
    </div>
</div>

<div class="bottom-nav">
    <div class="nav-item" onclick="location.reload()">üè†<br><span id="nav-home">–ê—Å–æ—Å”£</span></div>
    <div class="nav-item" onclick="toggleModal()">üë§<br><span id="nav-profile">–ü—Ä–æ—Ñ–∏–ª</span></div>
</div>

<div id="profileModal" class="modal">
    <div class="modal-content">
        <div class="modal-header" id="modal-title">–¢–∞–Ω–∑–∏–º–æ—Ç</div>
        
        <label id="label-lang">–ò–Ω—Ç–∏—Ö–æ–±–∏ –∑–∞–±–æ–Ω:</label>
        <select id="lang-select">
            <option value="ru">–†—É—Å—Å–∫–∏–π</option>
            <option value="en">English</option>
        </select>

        <label id="label-curr">–ò–Ω—Ç–∏—Ö–æ–±–∏ –∞—Å—ä–æ—Ä:</label>
        <select id="curr-select">
            <option value="usd">USD ($)</option>
            <option value="eur">EUR (‚Ç¨)</option>
            <option value="rub">RUB (‚ÇΩ)</option>
        </select>

        <button class="save-btn" onclick="applySettings()" id="btn-save">–ó–∞—Ö–∏—Ä–∞ –∫–∞—Ä–¥–∞–Ω</button>
    </div>
</div>

<script>
    // 1. –ú–ê–†–ö–ï–† –í–ê API-–ò –•–£–î–†–û –ò–ù“∂–û –ì–£–ó–û–†–ï–î
    const MY_MARKER = "701004"; 
    const MY_API_KEY = "71876b59812fee6e1539f9365e6a12dd"; 

    function toggleModal() {
        const modal = document.getElementById("profileModal");
        modal.style.display = (modal.style.display === "block") ? "none" : "block";
    }

    function applySettings() {
        localStorage.setItem("pref_lang", document.getElementById("lang-select").value);
        localStorage.setItem("pref_curr", document.getElementById("curr-select").value);
        location.reload(); 
    }

    window.onload = function() {
        const savedLang = localStorage.getItem("pref_lang") || "ru";
        const savedCurr = localStorage.getItem("pref_curr") || "usd";
        
        document.getElementById("lang-select").value = savedLang;
        document.getElementById("curr-select").value = savedCurr;

        // –¢–∞—Ä“∑—É–º–∞–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–∞ –∑–∞–±–æ–Ω–∏ –ê–Ω–≥–ª–∏—Å”£
        if(savedLang === "en") {
            document.getElementById("site-desc").innerText = "Flights, Hotels and Tours";
            document.getElementById("title-avia").innerText = "‚úàÔ∏è Cheap Flights";
            document.getElementById("title-klook").innerText = "üåç Tours and Activities";
            document.getElementById("nav-home").innerText = "Home";
            document.getElementById("nav-profile").innerText = "Profile";
            document.getElementById("btn-save").innerText = "Save Settings";
        }

        // –ë–æ—Ä–∫—É–Ω–∏–∏ –≤–∏“∑–µ—Ç–∏ Aviasales (–ß–∏–ø—Ç–∞“≥–æ)
        const aviaScript = document.createElement("script");
        aviaScript.src = `https://tp.media/content?currency=${savedCurr}&promo_id=4118&shmarker=${MY_MARKER}&type=search_widget&scope=flights&powered_by=false&search_host=www.jetradar.com&locale=${savedLang}&id=avia_widget`;
        aviaScript.charset = "utf-8";
        document.getElementById("avia-widget-container").appendChild(aviaScript);

        // –ë–æ—Ä–∫—É–Ω–∏–∏ –≤–∏“∑–µ—Ç–∏ Klook (–°–∞—ë“≥–∞—Ç“≥–æ)
        const klookScript = document.createElement("script");
        klookScript.src = `https://tp.media/content?promo_id=2088&shmarker=${MY_MARKER}&type=search_widget&locale=${savedLang}&id=klook_widget`;
        klookScript.charset = "utf-8";
        document.getElementById("klook-widget-container").appendChild(klookScript);
    }
</script>

</body>
</html>
